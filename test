#########################################################
# Do not edit below this line (unless running on a node that
#########################################################

# NCPUs = CPUs per task
NCPUS=1
			
# SCRIPT
SCRIPT=./gatk4_hc.sh
INPUTS=./Inputs/gatk4_hc.inputs

if [[ $PBS_QUEUE =~ bw-exec ]]; then CPN=28; else CPN=48; fi
M=$(( CPN / NCPUS )) #tasks per node

sed "s|^|${SCRIPT} |" ${INPUTS} > ${PBS_JOBFS}/input-file

mpirun --np $((M * PBS_NCPUS / CPN)) \
        --map-by node:PE=${NCPUS} \
        nci-parallel \
        --verbose \
        --input-file ${PBS_JOBFS}/input-file

